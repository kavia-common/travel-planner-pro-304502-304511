{"is_source_file": true, "format": "JavaScript", "description": "This file provides low-level HTTP helper functions for handling API requests, including authentication management, error handling, and event notifications for unauthorized access. It defines classes, constants, and functions related to making HTTP requests with token support and handling specific error cases like 401 Unauthorized.", "external_files": ["fetch API"], "external_methods": ["fetch"], "published": ["setAuthSession", "clearAuthSession", "getAccessToken", "getStoredUser", "onUnauthorized", "httpRequest"], "classes": [{"name": "ApiError", "description": "Custom error class for handling API-related errors, encapsulating message, status, and optional details."}], "methods": [{"name": "setAuthSession({ accessToken, user })", "description": "Stores access token and user info in localStorage for authenticated API requests.", "scope": "", "scopeKind": ""}, {"name": "clearAuthSession()", "description": "Removes stored authentication information from localStorage.", "scope": "", "scopeKind": ""}, {"name": "getAccessToken()", "description": "Retrieves the current access token from localStorage.", "scope": "", "scopeKind": ""}, {"name": "getStoredUser()", "description": "Retrieves and parses the stored user profile from localStorage.", "scope": "", "scopeKind": ""}, {"name": "onUnauthorized(listener)", "description": "Adds a listener function that will be called upon receiving a 401 Unauthorized response.", "scope": "", "scopeKind": ""}, {"name": "httpRequest(url, { method = \"GET\", headers, body, signal, auth = true } = {})", "description": "Performs an HTTP request with support for JSON payloads, token authentication, and error handling, returning parsed JSON or text.", "scope": "", "scopeKind": ""}, {"name": "constructor(message, { status, details } = {})", "scope": "ApiError", "scopeKind": "class", "description": "unavailable"}, {"name": "emitUnauthorized()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "normalizeDetails(details)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "safeJsonParse(value)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["fetch"], "search-terms": ["httpRequest", "ApiError", "localStorage", "token", "unauthorized", "fetch", "Bearer"], "state": 2, "file_id": 14, "knowledge_revision": 93, "git_revision": "0484b7866ca97829e539e7194f819d613551efbd", "revision_history": [{"44": "0484b7866ca97829e539e7194f819d613551efbd"}, {"93": "0484b7866ca97829e539e7194f819d613551efbd"}], "ctags": [{"_type": "tag", "name": "ApiError", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-304502-304511/travel_planner_frontend/src/api/http.js", "pattern": "/^class ApiError extends Error {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "TOKEN_STORAGE_KEY", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-304502-304511/travel_planner_frontend/src/api/http.js", "pattern": "/^const TOKEN_STORAGE_KEY = \"tp_access_token\";$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "USER_STORAGE_KEY", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-304502-304511/travel_planner_frontend/src/api/http.js", "pattern": "/^const USER_STORAGE_KEY = \"tp_user\";$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "clearAuthSession", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-304502-304511/travel_planner_frontend/src/api/http.js", "pattern": "/^export function clearAuthSession() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "constructor", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-304502-304511/travel_planner_frontend/src/api/http.js", "pattern": "/^  constructor(message, { status, details } = {}) {$/", "language": "JavaScript", "kind": "method", "signature": "(message, { status, details } = {})", "scope": "ApiError", "scopeKind": "class"}, {"_type": "tag", "name": "emitUnauthorized", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-304502-304511/travel_planner_frontend/src/api/http.js", "pattern": "/^function emitUnauthorized() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "getAccessToken", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-304502-304511/travel_planner_frontend/src/api/http.js", "pattern": "/^export function getAccessToken() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "getStoredUser", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-304502-304511/travel_planner_frontend/src/api/http.js", "pattern": "/^export function getStoredUser() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "httpRequest", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-304502-304511/travel_planner_frontend/src/api/http.js", "pattern": "/^export async function httpRequest(url, { method = \"GET\", headers, body, signal, auth = true } = /", "language": "JavaScript", "kind": "function", "signature": "(url, { method = \"GET\", headers, body, signal, auth = true } = {})"}, {"_type": "tag", "name": "normalizeDetails", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-304502-304511/travel_planner_frontend/src/api/http.js", "pattern": "/^function normalizeDetails(details) {$/", "language": "JavaScript", "kind": "function", "signature": "(details)"}, {"_type": "tag", "name": "onUnauthorized", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-304502-304511/travel_planner_frontend/src/api/http.js", "pattern": "/^export function onUnauthorized(listener) {$/", "language": "JavaScript", "kind": "function", "signature": "(listener)"}, {"_type": "tag", "name": "safeJsonParse", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-304502-304511/travel_planner_frontend/src/api/http.js", "pattern": "/^function safeJsonParse(value) {$/", "language": "JavaScript", "kind": "function", "signature": "(value)"}, {"_type": "tag", "name": "setAuthSession", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-304502-304511/travel_planner_frontend/src/api/http.js", "pattern": "/^export function setAuthSession({ accessToken, user }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ accessToken, user })"}, {"_type": "tag", "name": "unauthorizedListeners", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-304502-304511/travel_planner_frontend/src/api/http.js", "pattern": "/^const unauthorizedListeners = new Set();$/", "language": "JavaScript", "kind": "constant"}], "hash": "70178d007b3e016f9c9b11b94f966b47", "format-version": 4, "code-base-name": "travel_planner_frontend", "filename": "travel_planner_frontend/src/api/http.js"}